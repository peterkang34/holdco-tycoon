import type { PlatformRecipe } from '../engine/types';

export const PLATFORM_RECIPES: PlatformRecipe[] = [
  // ═══ WITHIN-SECTOR PLATFORMS ═══

  // ── Agency ──
  {
    id: 'agency_full_service_digital',
    name: 'Full-Service Digital Agency',
    sectorId: 'agency',
    requiredSubTypes: ['Digital/Ecommerce Agency', 'Performance Media Agency', 'SEO/Content Agency'],
    minSubTypes: 2,
    baseEbitdaThreshold: 5000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.03, multipleExpansion: 1.5, recessionResistanceReduction: 0.8 },
    integrationCostFraction: 0.20,
    description: 'Combine digital, performance, and content capabilities into one integrated agency.',
    realWorldExample: 'Tinuiti (New Mountain Capital), Wpromote (Z Capital)',
  },
  {
    id: 'agency_integrated_comms',
    name: 'Integrated Communications Group',
    sectorId: 'agency',
    requiredSubTypes: ['Creative/Brand Agency', 'PR / Communications', 'Influencer / Social Media'],
    minSubTypes: 2,
    baseEbitdaThreshold: 5000,
    bonuses: { marginBoost: 0.03, growthBoost: 0.02, multipleExpansion: 1.0, recessionResistanceReduction: 0.85 },
    integrationCostFraction: 0.18,
    description: 'Unified brand storytelling across creative, PR, and social influence.',
    realWorldExample: 'Stagwell, Weber Shandwick',
  },

  // ── SaaS ──
  {
    id: 'saas_vertical_suite',
    name: 'Vertical SaaS Suite',
    sectorId: 'saas',
    requiredSubTypes: ['Vertical-Market SaaS', 'Horizontal SaaS', 'Marketplace / Platform'],
    minSubTypes: 2,
    baseEbitdaThreshold: 8000,
    bonuses: { marginBoost: 0.05, growthBoost: 0.04, multipleExpansion: 2.0, recessionResistanceReduction: 0.75 },
    integrationCostFraction: 0.22,
    description: 'End-to-end vertical software platform owning the entire workflow.',
    realWorldExample: 'Toast (restaurants), ServiceTitan (home services)',
  },
  {
    id: 'saas_security_devops',
    name: 'Security & DevOps Platform',
    sectorId: 'saas',
    requiredSubTypes: ['Dev Tools / Infrastructure', 'Security / Compliance SaaS', 'Micro-SaaS Product'],
    minSubTypes: 2,
    baseEbitdaThreshold: 8000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.03, multipleExpansion: 1.5, recessionResistanceReduction: 0.8 },
    integrationCostFraction: 0.20,
    description: 'Combined developer tooling with compliance and security monitoring.',
  },

  // ── Home Services ──
  {
    id: 'home_multi_trade',
    name: 'Multi-Trade Home Services Platform',
    sectorId: 'homeServices',
    requiredSubTypes: ['HVAC Services', 'Plumbing Services', 'Electrical Services'],
    minSubTypes: 2,
    baseEbitdaThreshold: 5000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.03, multipleExpansion: 1.5, recessionResistanceReduction: 0.8 },
    integrationCostFraction: 0.20,
    description: 'Shared dispatch, fleet, and marketing across skilled trades.',
    realWorldExample: 'Apex Service Partners (Alpine Investors), Crete United (Ridgemont)',
  },
  {
    id: 'home_property_services',
    name: 'Property Services Group',
    sectorId: 'homeServices',
    requiredSubTypes: ['Pest Control', 'Roofing / Exterior Services', 'Landscaping / Lawn Care'],
    minSubTypes: 2,
    baseEbitdaThreshold: 5000,
    bonuses: { marginBoost: 0.03, growthBoost: 0.02, multipleExpansion: 1.0, recessionResistanceReduction: 0.85 },
    integrationCostFraction: 0.18,
    description: 'Complementary property maintenance with shared seasonal workforce.',
  },

  // ── Consumer Brands ──
  {
    id: 'consumer_multi_brand',
    name: 'Multi-Brand Consumer Portfolio',
    sectorId: 'consumer',
    requiredSubTypes: ['DTC / Ecommerce Brand', 'CPG / Household Goods', 'Beauty / Personal Care'],
    minSubTypes: 2,
    baseEbitdaThreshold: 5000,
    bonuses: { marginBoost: 0.03, growthBoost: 0.02, multipleExpansion: 1.0, recessionResistanceReduction: 0.85 },
    integrationCostFraction: 0.20,
    description: 'Shared fulfillment, supply chain, and digital marketing across brands.',
    realWorldExample: 'Unilever bolt-on strategy',
  },
  {
    id: 'consumer_artisanal_fb',
    name: 'Artisanal F&B House',
    sectorId: 'consumer',
    requiredSubTypes: ['Food & Beverage Brand', 'Specialty / Luxury Goods', 'Spirits / Wine'],
    minSubTypes: 2,
    baseEbitdaThreshold: 6000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.02, multipleExpansion: 1.5, recessionResistanceReduction: 0.85 },
    integrationCostFraction: 0.20,
    description: 'Premium food and spirits brands sharing distribution and lifestyle branding.',
    realWorldExample: 'Constellation Brands',
  },

  // ── Industrial ──
  {
    id: 'industrial_precision_mfg',
    name: 'Integrated Precision Manufacturing',
    sectorId: 'industrial',
    requiredSubTypes: ['Precision Parts / Components', 'Engineered Products', 'Contract Manufacturing / CNC Machining', 'Metal Fabrication'],
    minSubTypes: 2,
    baseEbitdaThreshold: 8000,
    bonuses: { marginBoost: 0.03, growthBoost: 0.02, multipleExpansion: 1.5, recessionResistanceReduction: 0.85 },
    integrationCostFraction: 0.22,
    description: 'Design-to-delivery manufacturing combining engineering, production, and finishing.',
    realWorldExample: 'KPS Capital platforms',
  },
  {
    id: 'industrial_aerospace_defense',
    name: 'Aerospace & Defense Services Group',
    sectorId: 'industrial',
    requiredSubTypes: ['Aerospace Aftermarket', 'Specialty Instruments / Testing', 'Packaging / Containers'],
    minSubTypes: 2,
    baseEbitdaThreshold: 10000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.01, multipleExpansion: 2.0, recessionResistanceReduction: 0.75 },
    integrationCostFraction: 0.25,
    description: 'Aerospace aftermarket with testing, certification, and packaging. Regulatory moat.',
    realWorldExample: 'TransDigm, HEICO',
  },

  // ── B2B Services ──
  {
    id: 'b2b_integrated_msp',
    name: 'Integrated MSP & Cyber Platform',
    sectorId: 'b2bServices',
    requiredSubTypes: ['IT Managed Services (MSP)', 'Data / Analytics Services', 'Marketing Operations'],
    minSubTypes: 2,
    baseEbitdaThreshold: 6000,
    bonuses: { marginBoost: 0.05, growthBoost: 0.03, multipleExpansion: 2.0, recessionResistanceReduction: 0.8 },
    integrationCostFraction: 0.20,
    description: 'Combined infrastructure management, security, and data analytics.',
    realWorldExample: 'Shield Technology Partners',
  },
  {
    id: 'b2b_professional_services',
    name: 'Professional Services Platform',
    sectorId: 'b2bServices',
    requiredSubTypes: ['Finance / Accounting Services', 'Consulting / Advisory', 'Legal Services'],
    minSubTypes: 2,
    baseEbitdaThreshold: 6000,
    bonuses: { marginBoost: 0.03, growthBoost: 0.02, multipleExpansion: 1.5, recessionResistanceReduction: 0.85 },
    integrationCostFraction: 0.18,
    description: 'Full-service outsourced CFO combining accounting, consulting, and legal.',
  },

  // ── Healthcare ──
  {
    id: 'healthcare_multi_specialty',
    name: 'Multi-Specialty Clinical Platform',
    sectorId: 'healthcare',
    requiredSubTypes: ['Physician Group / Multi-Specialty Practice', 'Dental Practice Group', 'Ophthalmology / Specialty Care', 'Physical Therapy / Rehab'],
    minSubTypes: 2,
    baseEbitdaThreshold: 8000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.03, multipleExpansion: 1.5, recessionResistanceReduction: 0.8 },
    integrationCostFraction: 0.22,
    description: 'Shared RCM, compliance, scheduling, and facilities across clinical specialties.',
    realWorldExample: 'MB2 Dental (Warburg Pincus), US Physical Therapy',
  },
  {
    id: 'healthcare_behavioral_home',
    name: 'Behavioral & Home Health Network',
    sectorId: 'healthcare',
    requiredSubTypes: ['Home Health / Hospice', 'Behavioral Health'],
    minSubTypes: 2,
    baseEbitdaThreshold: 6000,
    bonuses: { marginBoost: 0.03, growthBoost: 0.03, multipleExpansion: 1.0, recessionResistanceReduction: 0.8 },
    integrationCostFraction: 0.18,
    description: 'Integrated post-acute and behavioral care delivered outside hospital settings.',
  },

  // ── Restaurants ──
  {
    id: 'restaurant_multi_brand',
    name: 'Multi-Brand Restaurant Group',
    sectorId: 'restaurant',
    requiredSubTypes: ['QSR / Fast Casual Franchise', 'Coffee / Beverage Concept', 'Bakery / Dessert Concept'],
    minSubTypes: 2,
    baseEbitdaThreshold: 6000,
    bonuses: { marginBoost: 0.03, growthBoost: 0.02, multipleExpansion: 1.0, recessionResistanceReduction: 0.85 },
    integrationCostFraction: 0.20,
    description: 'Shared commissary, supply chain, and franchise ops across daypart concepts.',
    realWorldExample: 'Roark Capital (Inspire Brands), JAB Holdings',
  },
  {
    id: 'restaurant_ghost_catering',
    name: 'Ghost Kitchen & Catering Empire',
    sectorId: 'restaurant',
    requiredSubTypes: ['Ghost Kitchen / Delivery-First', 'Catering / Events', 'Specialty Food Concept'],
    minSubTypes: 2,
    baseEbitdaThreshold: 5000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.03, multipleExpansion: 1.0, recessionResistanceReduction: 0.85 },
    integrationCostFraction: 0.18,
    description: 'B2C delivery + B2B catering from shared kitchen infrastructure.',
  },

  // ── Real Estate ──
  {
    id: 'realestate_diversified',
    name: 'Diversified RE Operating Platform',
    sectorId: 'realEstate',
    requiredSubTypes: ['Self-Storage', 'Multi-Family Residential', 'Property Management'],
    minSubTypes: 2,
    baseEbitdaThreshold: 10000,
    bonuses: { marginBoost: 0.03, growthBoost: 0.02, multipleExpansion: 1.0, recessionResistanceReduction: 0.85 },
    integrationCostFraction: 0.20,
    description: 'Shared property management across asset types with cross-selling.',
    realWorldExample: 'Prime Group Holdings, SROA Capital',
  },

  // ── Education ──
  {
    id: 'education_workforce',
    name: 'Integrated Workforce Learning Platform',
    sectorId: 'education',
    requiredSubTypes: ['Online Learning Platform', 'Corporate Training', 'Coding Bootcamp'],
    minSubTypes: 2,
    baseEbitdaThreshold: 5000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.03, multipleExpansion: 1.5, recessionResistanceReduction: 0.8 },
    integrationCostFraction: 0.18,
    description: 'B2B upskilling + B2C learning with shared curriculum and credentialing.',
  },
  {
    id: 'education_early_enrichment',
    name: 'Early Education & Enrichment Group',
    sectorId: 'education',
    requiredSubTypes: ['Childcare / Early Education', 'Test Prep / Tutoring', 'Vocational / Trade School'],
    minSubTypes: 2,
    baseEbitdaThreshold: 5000,
    bonuses: { marginBoost: 0.03, growthBoost: 0.02, multipleExpansion: 1.0, recessionResistanceReduction: 0.85 },
    integrationCostFraction: 0.18,
    description: 'Full-spectrum youth development from childcare through career readiness.',
  },

  // ── Insurance ──
  {
    id: 'insurance_full_spectrum',
    name: 'Full-Spectrum Insurance Platform',
    sectorId: 'insurance',
    requiredSubTypes: ['P&C Agency', 'Employee Benefits Brokerage', 'Personal Lines'],
    minSubTypes: 2,
    baseEbitdaThreshold: 6000,
    bonuses: { marginBoost: 0.03, growthBoost: 0.02, multipleExpansion: 1.5, recessionResistanceReduction: 0.85 },
    integrationCostFraction: 0.18,
    description: 'One-call solution: commercial insurance + employee benefits + personal lines.',
    realWorldExample: 'Hub International, Acrisure',
  },
  {
    id: 'insurance_specialty_mga',
    name: 'Specialty MGA Platform',
    sectorId: 'insurance',
    requiredSubTypes: ['Specialty / Excess Lines', 'MGA / Program Admin'],
    minSubTypes: 2,
    baseEbitdaThreshold: 6000,
    bonuses: { marginBoost: 0.05, growthBoost: 0.03, multipleExpansion: 2.0, recessionResistanceReduction: 0.8 },
    integrationCostFraction: 0.22,
    description: 'Vertically integrated specialty underwriting + program administration.',
    realWorldExample: 'Doxa Insurance Holdings (Goldman Sachs AM)',
  },

  // ── Auto Services ──
  {
    id: 'auto_full_service',
    name: 'Full-Service Auto Care Platform',
    sectorId: 'autoServices',
    requiredSubTypes: ['Tire & Wheel', 'Quick Lube / Maintenance', 'Fleet Services'],
    minSubTypes: 2,
    baseEbitdaThreshold: 5000,
    bonuses: { marginBoost: 0.03, growthBoost: 0.02, multipleExpansion: 1.0, recessionResistanceReduction: 0.85 },
    integrationCostFraction: 0.18,
    description: 'Routine maintenance verticals with shared bays and cross-selling.',
    realWorldExample: 'Valvoline, Driven Brands',
  },
  {
    id: 'auto_collision_recon',
    name: 'Collision & Reconditioning Group',
    sectorId: 'autoServices',
    requiredSubTypes: ['Collision / Body', 'Auto Glass / Detailing', 'Car Wash'],
    minSubTypes: 2,
    baseEbitdaThreshold: 6000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.03, multipleExpansion: 1.5, recessionResistanceReduction: 0.85 },
    integrationCostFraction: 0.20,
    description: 'Collision repair + reconditioning with insurance DRP relationships.',
    realWorldExample: 'Quality Collision Group, Crash Champions',
  },

  // ── Distribution ──
  {
    id: 'distribution_supply_chain',
    name: 'Integrated Supply Chain Platform',
    sectorId: 'distribution',
    requiredSubTypes: ['Industrial / MRO Supply', 'Building Materials', 'Janitorial / Facilities Supply'],
    minSubTypes: 2,
    baseEbitdaThreshold: 6000,
    bonuses: { marginBoost: 0.03, growthBoost: 0.02, multipleExpansion: 1.0, recessionResistanceReduction: 0.85 },
    integrationCostFraction: 0.20,
    description: 'One-stop procurement for facilities, construction, and maintenance.',
    realWorldExample: 'SRS Distribution (Home Depot, $18B)',
  },
  {
    id: 'distribution_last_mile',
    name: 'Last-Mile & Specialty Logistics',
    sectorId: 'distribution',
    requiredSubTypes: ['Specialty / Niche', 'Last-Mile Delivery'],
    minSubTypes: 2,
    baseEbitdaThreshold: 6000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.03, multipleExpansion: 1.5, recessionResistanceReduction: 0.8 },
    integrationCostFraction: 0.20,
    description: 'Specialized last-mile delivery with niche product expertise.',
  },

  // ── Wealth Management ──
  {
    id: 'wm_comprehensive',
    name: 'Comprehensive Wealth Advisory Platform',
    sectorId: 'wealthManagement',
    requiredSubTypes: ['Independent RIA', 'Retirement Plan Advisory', 'Insurance-Based Advisory'],
    minSubTypes: 2,
    baseEbitdaThreshold: 6000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.03, multipleExpansion: 1.5, recessionResistanceReduction: 0.8 },
    integrationCostFraction: 0.20,
    description: 'Investment management + retirement plans + insurance under one advisor.',
    realWorldExample: 'PE-backed RIA roll-ups ($6T AUM)',
  },
  {
    id: 'wm_family_estate',
    name: 'Family Office & Estate Platform',
    sectorId: 'wealthManagement',
    requiredSubTypes: ['Family Office Services', 'Tax & Estate Planning'],
    minSubTypes: 2,
    baseEbitdaThreshold: 6000,
    bonuses: { marginBoost: 0.05, growthBoost: 0.01, multipleExpansion: 2.0, recessionResistanceReduction: 0.8 },
    integrationCostFraction: 0.22,
    description: 'Ultra-high-net-worth integrated tax, estate, and family governance.',
  },

  // ── Environmental ──
  {
    id: 'environmental_waste_recycling',
    name: 'Integrated Waste & Recycling Platform',
    sectorId: 'environmental',
    requiredSubTypes: ['Commercial Waste Collection', 'Residential Hauling', 'Recycling & Materials Recovery'],
    minSubTypes: 2,
    baseEbitdaThreshold: 6000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.02, multipleExpansion: 1.5, recessionResistanceReduction: 0.8 },
    integrationCostFraction: 0.22,
    description: 'Vertically integrated collection + recycling/processing platform.',
    realWorldExample: 'GFL Environmental ($8B exit)',
  },
  {
    id: 'environmental_remediation_industrial',
    name: 'Environmental Remediation & Industrial Services',
    sectorId: 'environmental',
    requiredSubTypes: ['Environmental Remediation', 'Industrial Waste Management', 'Portable Sanitation'],
    minSubTypes: 2,
    baseEbitdaThreshold: 6000,
    bonuses: { marginBoost: 0.03, growthBoost: 0.02, multipleExpansion: 1.0, recessionResistanceReduction: 0.85 },
    integrationCostFraction: 0.18,
    description: 'Cleanup + ongoing waste management + site services.',
  },

  // ═══ CROSS-SECTOR PLATFORMS ═══

  {
    id: 'cross_financial_services',
    name: 'Financial Services Platform',
    sectorId: null,
    crossSectorIds: ['insurance', 'wealthManagement'],
    requiredSubTypes: ['P&C Agency', 'Employee Benefits Brokerage', 'Independent RIA', 'Insurance-Based Advisory'],
    minSubTypes: 2,
    baseEbitdaThreshold: 8000,
    bonuses: { marginBoost: 0.05, growthBoost: 0.03, multipleExpansion: 2.0, recessionResistanceReduction: 0.75 },
    integrationCostFraction: 0.25,
    description: 'Combined risk management and wealth growth under one platform.',
    realWorldExample: 'Hub International, NFP (Aon)',
  },
  {
    id: 'cross_tech_enabled_services',
    name: 'Tech-Enabled Services Platform',
    sectorId: null,
    crossSectorIds: ['b2bServices', 'saas'],
    requiredSubTypes: ['IT Managed Services (MSP)', 'Data / Analytics Services', 'Vertical-Market SaaS', 'Dev Tools / Infrastructure'],
    minSubTypes: 2,
    baseEbitdaThreshold: 8000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.04, multipleExpansion: 2.0, recessionResistanceReduction: 0.75 },
    integrationCostFraction: 0.25,
    description: 'Human expertise + proprietary software. Services make software stickier.',
    realWorldExample: 'Accel-KKR platforms',
  },
  {
    id: 'cross_property_services',
    name: 'Property Services Superplatform',
    sectorId: null,
    crossSectorIds: ['homeServices', 'environmental'],
    requiredSubTypes: ['HVAC Services', 'Plumbing Services', 'Electrical Services', 'Commercial Waste Collection', 'Portable Sanitation'],
    minSubTypes: 2,
    baseEbitdaThreshold: 10000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.03, multipleExpansion: 1.5, recessionResistanceReduction: 0.75 },
    integrationCostFraction: 0.25,
    description: 'Full-property maintenance: interior services + environmental services.',
    realWorldExample: 'ABM Industries, CBRE',
  },
  {
    id: 'cross_healthcare_education',
    name: 'Healthcare & Education Continuum',
    sectorId: null,
    crossSectorIds: ['healthcare', 'education'],
    requiredSubTypes: ['Physician Group / Multi-Specialty Practice', 'Dental Practice Group', 'Corporate Training', 'Vocational / Trade School'],
    minSubTypes: 2,
    baseEbitdaThreshold: 10000,
    bonuses: { marginBoost: 0.03, growthBoost: 0.03, multipleExpansion: 1.0, recessionResistanceReduction: 0.8 },
    integrationCostFraction: 0.22,
    description: 'Healthcare systems that own their talent training pipeline.',
  },
  {
    id: 'cross_consumer_restaurant',
    name: 'Consumer & Restaurant Brand House',
    sectorId: null,
    crossSectorIds: ['consumer', 'restaurant'],
    requiredSubTypes: ['Food & Beverage Brand', 'QSR / Fast Casual Franchise', 'Coffee / Beverage Concept'],
    minSubTypes: 2,
    baseEbitdaThreshold: 8000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.03, multipleExpansion: 1.5, recessionResistanceReduction: 0.8 },
    integrationCostFraction: 0.22,
    description: 'Own the CPG brand AND the restaurant concept that serves it.',
    realWorldExample: 'JAB Holdings (Peets + Panera), Starbucks',
  },
  {
    id: 'cross_industrial_distribution',
    name: 'Vertically Integrated Industrial',
    sectorId: null,
    crossSectorIds: ['industrial', 'distribution'],
    requiredSubTypes: ['Precision Parts / Components', 'Engineered Products', 'Industrial / MRO Supply', 'Building Materials'],
    minSubTypes: 2,
    baseEbitdaThreshold: 10000,
    bonuses: { marginBoost: 0.04, growthBoost: 0.02, multipleExpansion: 1.5, recessionResistanceReduction: 0.8 },
    integrationCostFraction: 0.25,
    description: 'Manufacturing + distribution = margin control across the value chain.',
    realWorldExample: 'Parker Hannifin',
  },
];

export function getRecipesForSector(sectorId: string): PlatformRecipe[] {
  return PLATFORM_RECIPES.filter(r => r.sectorId === sectorId);
}

export function getCrossSectorRecipes(): PlatformRecipe[] {
  return PLATFORM_RECIPES.filter(r => r.sectorId === null);
}

export function getRecipeById(id: string): PlatformRecipe | undefined {
  return PLATFORM_RECIPES.find(r => r.id === id);
}
